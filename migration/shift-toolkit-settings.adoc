---
sidebar: sidebar 
permalink: migration/shift-toolkit-settings.html 
keywords: netapp, vmware, esxi, vm, migration, openshift, virtualization, hyper-v, proxmox 
summary: 在 Shift Toolkit 中設定進階設置，以管理 CredSSP 驗證、啟用日誌記錄和偵錯、存取 REST API 以及設定遷移作業的電子郵件通知。 
---
= 在 Shift 工具包中配置進階設置
:hardbreaks:
:allow-uri-read: 
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ../media/


[role="lead"]
在 Shift Toolkit 中設定進階設置，以管理 CredSSP 驗證、啟用日誌記錄和偵錯、存取 REST API 以及設定遷移作業的電子郵件通知。

點擊頂部工具列中的「設定」圖標，即可存取進階設定。

image::shift-toolkit-250.png[Shift Toolkit 工具列中的「設定」圖標]



== 憑證安全服務提供者 (CredSSP)

Shift Toolkit 使用憑證安全服務提供者 (CredSSP) 來管理轉換過程中的憑證傳輸。  Shift 伺服器在被轉換的虛擬機器的客戶作業系統上執行腳本，透過 Hyper-V 伺服器從 Shift 伺服器向客戶作業系統「雙跳」傳遞憑證。

image::shift-toolkit-251.png[CredSSP 配置設定]



=== 將 Shift 伺服器配置為 CredSSP 用戶端

進階設定精靈會自動將 Shift 伺服器設定為 CredSSP 用戶端，使其能夠將憑證委派給 Hyper-V 伺服器。



==== 幕後花絮

Shift Toolkit 執行下列指令和政策配置，將自身設定為客戶端：

*已執行的指令：*

* `Set-Item WSMan:\localhost\Client\TrustedHosts -Value "fqdn-of-hyper-v-host"`
* `Enable-WSManCredSSP -Role client -DelegateComputer "fqdn-of-hyper-v-host"`


*已配置群組原則：*

* 電腦設定 > 管理範本 > 系統 > 憑證委派 > 允許使用僅 NTLM 伺服器驗證委派新憑證
+
啟用此策略並新增 `wsman/fqdn-of-hyper-v-host`。





=== 將 Hyper-V 伺服器配置為 CredSSP 伺服器

使用 `Enable-WSManCredSSP`使用 Hyper-V 伺服器上的 cmdlet 將其配置為 CredSSP 伺服器，使其能夠從 Shift 伺服器接收憑證。

.步驟
. 在 Shift Toolkit 伺服器將要設定虛擬機器的 Hyper-V 主機上，以管理員身分開啟 Windows PowerShell 工作階段。
. 運行以下命令：
+
[listing]
----
Enable-PSRemoting
Enable-WSManCredSSP -Role server
----




== 日誌記錄和調試

Shift Toolkit 包含預設日誌記錄功能，保留期限為 30 天。根據技術支援的要求，日誌記錄可以切換到調試模式，以便進行故障排除。

image::shift-toolkit-252.png[日誌配置設定]



== 昂首闊步

進階設定中的 Swagger 頁面可讓您與 Shift Toolkit REST API 進行互動。

image::shift-toolkit-253.png[Swagger API 文件介面]

Shift Toolkit REST API 提供對遷移、轉換和自動化功能的程式存取。  API 依功能性工作流程組織，以協助您快速找到完成特定任務所需的資源。

image::shift-toolkit-254.png[API資源類別]



=== 身份驗證和設定 API

使用這些 API 來建立連接、管理使用者以及配置 Shift Toolkit 伺服器的身份驗證。

*會議*

管理使用者身份驗證並取得 API 請求的授權令牌：

* 開始會話
* 驗證會話
* 取得所有會話 ID
* 結束會話


*用戶*

管理使用者帳號和權限：

* 新增用戶
* 取得所有用戶
* 更改使用者密碼
* 接受 EULA


*CredSSP*

配置憑證安全服務提供者以進行憑證委派：

* 啟用 CredSSP
* 取得 CredSSP 狀態


*連接器*

管理與基礎架構元件的連線：

* 新增連接器
* 獲取所有連接器的詳細信息
* 按 ID 更新連接器詳細信息
* 透過 ID 獲取連接器詳細信息


*租戶*

管理多租戶配置：

* 新增租戶
* 獲取所有租戶信息




=== 基礎架構管理 API

使用這些 API 來配置和發現您的來源環境和目標環境。

*地點*

管理遷移站點及其相關的虛擬和儲存環境：

* 取得網站數量
* 獲取所有站點詳細信息
* 新增站點
* 透過 ID 取得網站詳細信息
* 根據 ID 刪除站點
* 新增虛擬環境
* 將儲存環境新增至站點
* 獲取站點的虛擬環境詳細信息
* 更新網站的虛擬環境詳細信息
* 刪除網站的虛擬環境詳細信息
* 獲取站點的存儲環境詳細信息
* 更新網站的儲存環境詳細信息
* 刪除網站的儲存環境詳細信息


*發現*

發現並清點來源站點和目標站點中的虛擬機器和資源：

* 發現來源站點
* 取得來源站點的所有發現請求
* 發現目標站點
* 取得目標網站的所有發現請求
* 透過 ID 取得來源站點的發現步驟
* 透過 ID 取得目標網站的發現步驟




=== 虛擬機器和資源管理 API

使用這些 API 來清點、組織和管理虛擬機器和資源以進行遷移。

*虛擬機器*

查詢與管理虛擬機器：

* 取得來源中的站點和虛擬環境的虛擬機
* 為站點和虛擬環境取得未受保護的虛擬機
* 取得虛擬機器數量
* 取得受保護的虛擬機器數量


*資源*

查看資源利用率和可用性：

* 取得網站和虛擬環境的資源詳細信息
* 取得來源站點資源數量


*資源組*

將虛擬機器組織成保護群組以便進行遷移：

* 取得保護組數量
* 獲取所有保護組詳細信息
* 新增保護組
* 透過 ID 取得保護組詳細信息
* 透過 ID 刪除保護群組
* 按 ID 更新保護組詳細信息
* 透過 ID 取得保護群組中的虛擬機
* 取得包含保護群組的藍圖




=== 遷移和復原 API

使用這些 API 來執行遷移、監控合規性和管理復原作業。

*藍圖*

定義和管理遷移藍圖：

* 取得藍圖數量
* 獲取所有藍圖詳細信息
* 新增藍圖
* 透過 ID 取得藍圖詳情
* 按ID刪除藍圖
* 更新 ID 的藍圖詳情
* 取得藍圖的虛擬機
* 取得藍圖中虛擬機器的電源狀態


*遵守*

遷移前請確認準備與相容性：

* 取得藍圖的合規性檢查結果
* 取得藍圖的合規性檢查最終狀態
* 為藍圖添加按需合規性檢查


*執行*

監控遷移和轉換作業的執行：

* 取得所有執行細節
* 獲取正在執行的詳細信息
* 取得執行次數
* 獲取正在進行的執行次數
* 取得執行 ID 的步驟


*恢復*

執行和管理遷移和復原作業：

* 為藍圖新增新的執行請求
* 為藍圖新增執行重試請求
* 取得所有藍圖的執行狀態
* 取得藍圖 ID 的執行狀態




=== 自動化 API

使用這些 API 來擴充和自動化 Shift Toolkit 的功能。

*腳本區塊*

訪問並執行自動化腳本：

* 取得所有腳本元數據
* 透過 ID 取得腳本元數據
* 取得所有刷新元數據
* 執行腳本




== 腳本區塊和自動化

Shift Toolkit 中的腳本區塊提供了範例程式碼，可協助您使用內部和外部 API 來實現自動化、整合和開發功能。瀏覽並下載程式碼範例部分中的範例，這些範例由 Shift Toolkit 自動化團隊和社群成員編寫。使用這些範例開始執行自動化、管理或整合任務。

image::shift-toolkit-255.png[腳本區塊介面]

image::shift-toolkit-256.png[可用的程式碼範例]

以下範例展示了一個 PowerShell 腳本，用於刪除 Shift Toolkit UI 中的特定作業。雖然標準工作流程中沒有提供此功能，但可以使用腳本區塊來實現。該腳本還可以作為批次腳本提供，可以輕鬆下載和執行。

image::shift-toolkit-257.png[用於刪除作業的 PowerShell 腳本範例]

腳本區塊的目標是提供使用 Shift Toolkit API 和相應虛擬機器管理程式發布的 API 在特定虛擬機器管理程式上進行第 0 天和持續操作的範例腳本。

腳本區塊的目標是提供使用 Shift Toolkit API 和相應虛擬機器管理程式發布的 API 在特定虛擬機器管理程式上進行第 0 天和持續操作的範例腳本。



== 電子郵件通知與提醒

設定電子郵件通知，向指定收件者傳送有關發現、轉換或遷移作業的警報。  UI 通知（介面內的警報）也可用，並儲存 7 天。

從「設定」>「平台設定」>「電子郵件設定」存取電子郵件通知設定。

.步驟
. 登入 Shift Toolkit 使用者介面。
. 前往“設定”>“平台設定”。
. 選擇電子郵件通知並更新 SMTP 詳細資訊：
+
** SMTP 伺服器位址
** 港口
** 使用者名稱
** 密碼


. 更新收件人字段，並從可用類別中選擇事件。
. 按一下“*應用*”。


image::shift-toolkit-258.png[電子郵件通知配置設定]

截圖顯示了每個通知類別和事件的細分情況。


NOTE: 此版本中，電子郵件通知使用基本的 SMTP 驗證和 SendGrid。未來的版本將支援現代身份驗證。


NOTE: 此版本中，電子郵件通知使用基本的 SMTP 驗證和 SendGrid。未來的版本將支援現代身份驗證。



== 中止並恢復功能

Shift Toolkit 提供了在工作流程的任何步驟取消正在執行的作業的選項。取消作業時，所有孤立元件都會自動清理，包括：

* 如果虛擬機器已啟動，則在虛擬機器管理程式上將其關閉。
* 從對應的 qtree 移除磁碟條目
* 刪除持續性銷售聲明 (PVC)


由於 Shift Toolkit 不會以任何方式修改來源虛擬機，因此回滾非常簡單，只需啟動來源虛擬機即可。無需採取其他回滾操作。
